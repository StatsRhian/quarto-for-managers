---
title: Quarto for managers
subtitle: The magic of automatic reporting âœ¨ 
author: Rhian Davies
format: 
  revealjs: 
    self-contained: true
execute:
    echo: true
    eval: false
footer: "{{< fa brands github >}} {{< fa brands bluesky >}} {{< fa brands mastodon >}} {{< fa brands linkedin >}} [@statsRhian](https://bsky.app/profile/statsrhian.bsky.social) &nbsp; {{< fa laptop-code >}} [statsrhian.github.io/quarto-for-managers](https://statsrhian.github.io/quarto-for-managers)"
---

## Meet Maria


::: columns
::: {.column width="60%"}
- Public Health analyst
- Delivers monthly reports on NHS Workforce statistics
- Uses Excel & R to analyse data
- Uses Word to write branded reports
:::

::: {.column width="40%"}
![](img/maria.svg){fig-alt="Cartoon of a woman smiling"}
:::
:::

## Monthly Reports

![](img/flow-1.png){fig-alt="Cartoon of a spreadsheet" fig-align="center"}

## Monthly Reports

![](img/flow-2.png){fig-alt="Cartoon of a spreadsheet, then a woman coding." fig-align="center"}

## Monthly Reports

![](img/flow-3.png){fig-alt="Cartoon of a spreadsheet, then a woman coding, and then a women designing a pie chart." fig-align="center"}

## Monthly Reports

![](img/flow-4.png){fig-alt="Cartoon of a spreadsheet, then a woman coding, and then a women designing a pie chart and finally a woman writing some notes." fig-align="center"}

## Back to square one

::: {.incremental}
* The data was wrong â€” can you re-run the analysis?

* Your manager loves it â€” can you do it for another region?

* Next month â€” do it all again.
:::


# There must be a better way

# Hello quarto ğŸ‘‹

## What is quarto?

![](img/quarto.jpg){fig-alt="The quarto logo: A circle cut into four quadrants next to the word quarto"}

> An **open-source** scientific and technical **publishing** system

## 

![Artwork from "Hello, Quarto" keynote by Julia Lowndes and Mine Ã‡etinkaya-Rundel, presented at RStudio Conference 2022. Illustrated by Allison Horst.](img/quarto-flow.png){fig-alt="A schematic representing the multi-language input (e.g. Python, R, Observable, Julia) and multi-format output (e.g. PDF, html, Word documents, and more) versatility of Quarto."}

## ğŸ‘€ Demo: Creating a new report



## ğŸ‘©â€ğŸ’» Your turn: New report

- Open <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">binder</a>
  <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">
    <img src="http://mybinder.org/badge_logo.svg" alt="Launch RStudio Binder">
  </a>
- _File_ â¡ï¸ _New File_ â¡ï¸ _Quarto Document_
- Enter _Title_ & _Author_
- Leave _HTML_ selected
- Click _Create_
- Click _Render Document_ (you'll be prompted to save first)
- Try changing some text and then re-rendering with _Render Document_

# Interweave text and code ğŸ§¶

## ğŸ‘€ Demo: Simple plot and text


## ğŸ‘©â€ğŸ’» Your turn: New report

- Open <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">binder</a>
  <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">
    <img src="http://mybinder.org/badge_logo.svg" alt="Launch RStudio Binder">
  </a>
- Open `exercise-2/simple.qmd`
- Click _Render_
- Change `blue` to `red` and re-render
- Change the `filter` to `> 2024-12-31` and re-render

# Parameterisation âš™ï¸
  
## Example report

![](img/ne-april.png)

## Template based-reports

```{r}
#| code-line-numbers: "1-8|6-8|2-3"
---
title:"NHS Workforce Statistics for `r params$ics_name`"
subtitle:"Data for `r params$month_year`"
author:"Maria Garcia"
date:"2023-09-28"
params:
  ics_name:"North East and North Cumbria"
  month_year:"April 2023"
---
```


  
## Read in the data
  
```{r read-data}
  filename
= glue(
  "NHS Workforce Statistics, {params$month_year} England and Organisation.xlsx"
)
```

## Clean the data

```{r}
#| code-line-numbers: "3"
staff_group =
  staff_group |>
  filter(`ICS name` == params$ics_name) |>
  select(
    `Organisation name`,
    `Total`,
    `HCHS Doctors`,
    `Nurses & health visitors`,
    `Midwives`,
    `Ambulance staff`
  )
```



## Add insight

````{r}
The table below shows the total number of doctors and nurses for each organisation within `r params$ics_name`. We can see that the organisation with the most midwives is the `r pull(max_midwives, "Organisation name")` with `r round(max_midwives$Midwives)` staff.
````

## Re-run next month

````{r re-run}
#| code-line-numbers: "8"
---
title: "NHS Workforce Statistics for `r params$ics_name`"
subtitle: "Data for `r params$month_year`"
author: "Maria Garcia"
date: "2023-09-28"
params:
  ics_name: "North East and North Cumbria"
  month_year: "May 2023"
````

##  {background-image="img/ne-may.png"}

## Report a different region

````{bash}
#| code-line-numbers: "7"
---
title: "NHS Workforce Statistics for `r params$ics_name`"
subtitle: "Data for `r params$month_year`"
author: "Maria Garcia"
date: "2023-09-28"
params:
  ics_name: "Lancashire and South Cumbria"
  month_year: "May 2023"
````

##  {background-image="img/nw-may.png"}


## ğŸ‘©â€ğŸ’» Your turn: Parameters

- Open <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">binder</a>
  <a href="https://mybinder.org/v2/gh/StatsRhian/demo-quarto-for-managers/main?urlpath=rstudio" target="_blank">
    <img src="http://mybinder.org/badge_logo.svg" alt="Launch RStudio Binder">
  </a>
- Open `exercise-3/example-report.qmd`
- Change `month_year: July 2025` to `June 2025` and re-render
- Change `ics_name: "North East and North Cumbria"` to [another ICS](https://www.england.nhs.uk/system-and-organisational-oversight/system-directory/)

## Maria is happy

::: columns
::: {.column width="60%"}
- More reproducible workflow
- Fewer mistakes
- Spends less time formatting the reports manually 
- Spends more time adding insight
:::

::: {.column width="40%"}
![](img/maria.svg){fig-alt="Cartoon of a woman smiling"}
:::
:::
